<template id="tani-image-template">
  <style>
    img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      cursor: pointer;
    }
  </style>
  <picture>
    <source type="image/webp">
    <img>
  </picture>
</template>

<script>
{
  const currentScript = document.currentScript;
  const ownerDocument = currentScript.ownerDocument;

  class TaniImage extends HTMLElement {
    constructor() {
      super();
    }

    get src() {
      return `img/tani/${this.id}.jpg`;
    }

    get srcset() {
      return `img/tani/${this.id}.webp`;
    }

    createdCallback() {
      this.attachShadow({ mode : 'open' });
      const template = ownerDocument.querySelector('#tani-image-template');
      const clone = document.importNode(template.content, true);
      this.shadowRoot.appendChild(clone);
    }

    attachedCallback() {
      this.shadowRoot.querySelector('img').src = this.src;
      this.shadowRoot.querySelector('source').src = this.srcset;
    }
  }

  document.registerElement('tani-image', TaniImage);
}
</script>
