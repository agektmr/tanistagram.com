<template id="tani-image-template">
  <style>
    img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      cursor: pointer;
    }
  </style>
  <picture>
    <source type="image/webp">
    <img>
  </picture>
</template>

<script>
{
  const currentScript = document.currentScript;
  const ownerDocument = currentScript.ownerDocument;

  class TaniImage extends HTMLElement {
    get src() {
      return `img/tani/${this.id}.jpg`;
    }

    get srcset() {
      return `img/tani/${this.id}.webp`;
    }

    constructor() {
      super();

      this.attachShadow({ mode : 'open' });
      const template = ownerDocument.querySelector('#tani-image-template');
      const clone = template.content.cloneNode(true);
      this.shadowRoot.appendChild(clone);
    }

    connectedCallback() {
      this.shadowRoot.querySelector('img').src = this.src;
      this.shadowRoot.querySelector('source').src = this.srcset;
    }
  }

  customElements.define('tani-image', TaniImage);
}
</script>
