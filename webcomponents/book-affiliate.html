<template id="book-affiliate-template">
  <style>
    img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      cursor: pointer;
    }
  </style>
  <a target="_blank">
    <img style="border: none;" />
  </a>
</template>

<script>
{
  const currentScript = document.currentScript;
  const ownerDocument = currentScript.ownerDocument;

  class BookAffiliate extends HTMLElement {
    constructor() {
      super();
    }

    get url() {
      return this.getAttribute('url');
    }

    get src() {
      return `img/book/${this.getAttribute('name')}.jpg`;
    }

    get title() {
      return this.getAttribute('title');
    }

    createdCallback() {
      this.attachShadow({ mode : 'open' });
      const template = ownerDocument.querySelector('#book-affiliate-template');
      const clone = document.importNode(template.content, true);
      this.shadowRoot.appendChild(clone);
    }

    attachedCallback() {
      this.shadowRoot.querySelector('a').href = this.url;
      this.shadowRoot.querySelector('img').src = this.src;
      this.shadowRoot.querySelector('img').alt = this.title;
    }
  }

  document.registerElement('book-affiliate', BookAffiliate);
}
</script>
